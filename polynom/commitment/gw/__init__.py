#implements Section 5 of https://eprint.iacr.org/2021/1167.pdf
